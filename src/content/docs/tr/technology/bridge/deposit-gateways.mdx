---
section: technology
date: Last Modified
title: "Yatırım Geçitleri(Deposit Gateways)"
lang: "tr"
permalink: "technology/bridge/deposit-gateways"
whatsnext: { "Çekim Geçitleri (Withdraw Gateways)": "/tr/technology/bridge/withdraw-gateways/" }
---

import ClickToZoom from "../../../../../components/ClickToZoom.astro"
import DepositWorkflow from "../_images/deposit.png"

Bu belge, kullanıcıların ve geliştiricilerin L1'den L2'ye jeton yatırmak için geçitleri nasıl kullanacaklarını açıklar. Standart jetonlar için birkaç geçit ve L1'de bir geçit yönlendirici sağlıyoruz. Bunlar aşağıdaki tabloda listelenmiştir.

| Gateway Contract         | Description                                                      |
| ------------------------ | ---------------------------------------------------------------- |
| `L1GatewayRouter`        | ETH ve ERC20 tokenlarının yatırımını destekleyen geçit kapısı.   |
| `L1ETHGateway`           | ETH yatırmak için geçiş kapısı.                                  |
| `L1StandardERC20Gateway` | Standart ERC20 token yatırmak için geçiş kapısı.                 |
| `L1CustomERC20Gateway`   | Özel ERC20 token yatırmak için geçiş kapısı.                     |
| `L1WETHGateway`          | Wrapped ETH yatırmak için geçiş kapısı.                          |
| `L1ERC721Gateway`        | ERC721 token yatırmak için geçiş kapısı.                         |
| `L1ERC1155Gateway`       | ERC1155 token yatırmak için geçiş kapısı.                        |

## Overview

<ClickToZoom src={DepositWorkflow} alt="Deposit Workflow" />

Şekil, L1'den L2'ye token yatırma işlem akışını tasvir etmektedir. Kullanıcılar token yatırma işlemlerini başlatmak için gateway'leri ararlar. Yatırma işlemi daha sonra bir mesaja kodlanır ve `L1ScrollMessenger` sözleşmesine gönderilir ve buna karşılık gelen bir L1 başlatılmış işlem `L1MessageQueue`'ya eklenir. L2'deki yatırımları tamamlamak için, L2 sıralayıcıları yeni L1 işlem etkinliklerini toplar ve bunları oluşturduğu L2 bloklarına dahil eder. İlerleyen bölümler, farklı token türlerinin nasıl yatırıldığıyla ilgili ayrıntıları açıklar. L1'den L2'ye mesaj iletme akışı hakkında daha fazla bilgiyi [Cross-Domain Mesaj İletimi](/tr/technology/bridge/cross-domain-messaging) bölümünde bulabilirsiniz.

## ETH Yatırma

Scroll, ETH'yi kendi yerel tokenı olarak kabul eder. L2'deki `L2ScrollMessenger` sözleşmesine yeterli miktarda ETH tahsis edilir, böylece tokenları madencilik yapmadan L2 hesaplarına aktarabilir. ETH yatırma işlemi şu şekilde gerçekleşir:

1. `L1GatewayRouter`, L1'den L2'ye ETH yatırmak için üç fonksiyon sağlar. `depositETHAndCall` fonksiyonu, ETH'yi transfer edebilir ve aynı anda bir sözleşme çağrısı yapabilir.

    ```solidity
    function depositETH(uint256 _amount, uint256 _gasLimit) external payable;

    function depositETH(address _to, uint256 _amount, uint256 _gasLimit) public payable;

    function depositETHAndCall(
        address _to,
        uint256 _amount,
        bytes calldata _data,
        uint256 _gasLimit
    ) external payable;
    ```

2. Tüm üç depositETH işlevi `L1ETHGateway`'e çağrı yapar. `L1ETHGateway`, yatırımı `L1ScrollMessenger` sözleşmesine gönderilen bir mesaja kodlar.

3. Yatırılan miktarın ETH'si, `L1ScrollMessenger` sözleşmesinde kilitlenir. `L1ScrollMessenger`, mesajı `L1MessageQueue` sözleşmesindeki mesaj kuyruğuna ekler.

4. Yatırım işlemi L1'de tamamlandıktan sonra, sıralayıcı ilgili bir L2 işlemini L2 bloğuna dahil eder ve yatırımı tamamlar ve ETH'yi L2'deki alıcı adresine aktarır.

5. L2 işlemi, `L2ScrollMessenger.relayMessage` işlevini çağırır, bu da iletilecek mesajı yürütür. ETH yatırımı durumunda, `relayMessage` işlevi, ETH'yi L2'deki alıcı hesabına aktarmak için `L2ETHGateway.finalizeDepositETH`'i çağırır.

6. Kullanıcı L1'de `depositETHAndCall`'ı çağırırsa, `L2ETHGateway` sözleşmesindeki `finalizeDepositETH`, ek verileri hedef L2 sözleşmesine iletecektir.

## ERC20 Tokenları Yatırma

Farklı türdeki ERC20 tokenlarını (standart ERC20 tokenlar, özel ERC20 tokenlar ve Wrapped ETH token gibi) birleştirmek için birkaç ERC20 geçit sözleşmesi sağlanmaktadır. `L1GatewayRouter`, ERC20 tokenlarını L1'deki ilgili ERC20 geçidiyle eşleştiren kanonik eşleştirmeyi kaydeder. `L1GatewayRouter`, özel bir geçit zaten kurulmuşsa, yeni ERC20 tokenları için varsayılan olarak `StandardERC20Gateway`'i kullanır.

ERC20 tokenlarının yatırılması aşağıdaki gibi çalışır.

1. L1'den L2'ye ERC20 tokenları yatırmak için, kullanıcılar aşağıdaki gibi `L1GatewayRouter.depositERC20` ve `L1GatewayRouter.depositERC20AndCall` kullanabilir.

    ```solidity
    function depositERC20(address _token, uint256 _amount, uint256 _gasLimit) external payable;

    function depositERC20(address _token, address _to, uint256 _amount, uint256 _gasLimit) external payable;

    function depositERC20AndCall(
        address _token,
        address _to,
        uint256 _amount,
        bytes memory _data,
        uint256 _gasLimit
    ) public payable;
    ```

2. ERC20 tokenlardan geçide yapılan eşlemeye dayanarak, `L1GatewayRouter`, karşılık gelen geçidi çağırır: `L1StandardERC20Gateway`, `1CustomERC20Gateway` veya `L1WETHGateway`. Kalan adımlar ayrıntılı olarak açıklanacaktır.

### Standart ERC20 Tokenları

Standart ERC20 tokenları, özel bir mantık gerektirmeyen tokenlardır. Bu tür tokenlar için, L2 ERC20 token sözleşmeleri `L2StandardERC20Gateway` tarafından oluşturulur. Standart ERC20 token yatırımının kalan adımları şöyledir:

3. `L1StandardERC20Gateway` sözleşmesi, ERC20 tokenlarını gönderenden kendisine aktararak tokenları kilitler.
4. Eğer bu ERC20 tokenı daha önce `L1StandardERC20Gateway` aracılığıyla çekilmediyse, `L1StandardERC20Gateway`, belirlenmiş bir L2 ERC20 token adresini hesaplar ve belki de sözleşmenin L2'de dağıtılması için potansiyel olarak sözleşme oluşturulması için mesajın içine token metadatasını (sembol, isim ve ondalıklar) ekler. L2 token adresi zaten `tokenMapping` içinde saklanıyorsa, `L1StandardERC20Gateway` doğrudan L2 token adresini eşlemeden yükler.
5. `L1StandardERC20Gateway`, token yatırımı mesajını kodlar ve mesajı göndermek için `L1ScrollMessenger`'ı çağırır.
6. Karşılık gelen L2 işlemi, yatırımı L2'de tamamlamak için `L2ScrollMessenger.relayMessage` işlevini çağırır. Standart ERC20 token yatırımlarında, işlem daha sonra `L2StandardERC20Gateway.finalizeDepositERC20`'ı çağırır.
7. Bu ERC20 token sözleşmesi L2'de daha önce dağıtılmadıysa, `L2StandardERC20Gateway` mesajdan token metadatasını çıkarır ve standart ERC20 tokenunu L2'de dağıtmak için `ScrollStandardERC20Factory`'i çağırır.
8. `L2StandardERC20Gateway`, karşılık gelen L2 ERC20 token sözleşmesinde mint işlevini çağırır.
9. Kullanıcı L1'de `depositERC20AndCall`'ı çağırırsa, `L2StandardERC20Gateway`, hedef L2 sözleşmesini ek verilerle çağırır.

### Özel ERC20 Tokenları

Standart ERC20 tokenlarına kıyasla, özel ERC20 tokenların L2 sözleşmeleri token sahibi tarafından dağıtılır. Özel ERC20 token yatırımının kalan adımları şöyledir:

3. `L1CustomERC20Gateway` sözleşmesi, ERC20 tokenlarını L1'de gönderenden kendisine aktararak tokenları kilitler.
4. `L1CustomERC20Gateway`, `tokenMapping` içinde bir L2 ERC20 token adresinin bulunmasını gerektirir. Karşılık gelen ERC20 token adresini alır, token yatırımı mesajını kodlar ve `L1ScrollMessenger`'a iletir.
5. Karşılık gelen L2 işlemi, yatırımı L2'de tamamlamak için `L2ScrollMessenger.relayMessage` işlevini çağırır. Özel ERC20 token yatırımlarında, işlem `L2CustomERC20Gateway.finalizeDepositERC20`'ı çağırır.
6. `L2CustomERC20Gateway`, karşılık gelen L2 ERC20 token sözleşmesinde mint işlevini çağırır. L2 ERC20 token sözleşmesinin, mint izinlerini `L2CustomERC20Gateway` sözleşmesine vermesi gerekmektedir.
7. Kullanıcı L1'de `depositERC20AndCall`'ı çağırırsa, `L2CustomERC20Gateway`, hedef L2 sözleşmesini ek verilerle çağırır.

### WETH Token

L1'de Wrapped ETH tokenı için özel bir geçit olan `L1WETHGateway` sağlarız ve geçit adresini `L1GatewayRouter`'da kaydederiz. WETH tokenı yatırımı aşağıdaki gibi çalışır.

3. `L1WETHGateway`, WETH tokenlarını gönderenden kendisine aktararak WETH tokenunu çözer ve ETH tokenını ve (komisyonu ödemek için) `msg.value`'yi birlikte `L1ScrollMessenger` sözleşmesine gönderir.
4. `L1WETHGateway`, token yatırımı mesajını kodlar ve `L1ScrollMessenger`'a iletir.
5. Karşılık gelen L2 işlemi, yatırımı L2'de tamamlamak için `L2ScrollMessenger.relayMessage` işlevini çağırır. WETH token yatırımı durumunda, işlem `L2WETHGateway.finalizeDepositERC20`'ı çağırır.
6. `L2WETHGateway`, yatırılan ETH'yi L2 WETH tokenuna tekrar sarar ve bunu L2'deki alıcı adresine aktarır.
7. Kullanıcı L1'de `depositERC20AndCall`'ı çağırırsa, `L2WETHGateway`, hedef L2 sözleşmesini ek verilerle çağırır.

## ERC-721/ERC-1155 Tokenları Yatırma

ERC-721 veya ERC-1155 token yatırımı, ERC-20 tokenlarına çok benzer şekilde çalışır. ERC-721 veya ERC-1155 tokenlarını L1'den yatırmak için `L1ERC721Gateway` veya `L1ERC1155Gateway` geçitlerini kullanabilirsiniz.

```solidity
function depositERC721(
    address _token,
    uint256 _tokenId,
    uint256 _gasLimit
) external payable;

function depositERC721(
    address _token,
    address _to,
    uint256 _tokenId,
    uint256 _gasLimit
) external payable;

function depositERC1155(
    address _token,
    uint256 _tokenId,
    uint256 _amount,
    uint256 _gasLimit
) external payable;

function depositERC1155(
    address _token,
    address _to,
    uint256 _tokenId,
    uint256 _amount,
    uint256 _gasLimit
) external payable;
```

Birçok ERC-721 veya ERC-1155 token yatırımını kolaylaştırmak için, aşağıdaki işlevler aracılığıyla `L1ERC721Gateway` ve `L1ERC1155Gateway` kontratlarında toplu yatırım işlevleri sağlanır:

```solidity
function batchDepositERC721(
    address _token,
    uint256[] calldata _tokenIds,
    uint256 _gasLimit
) external payable;

function batchDepositERC721(
    address _token,
    address _to,
    uint256[] calldata _tokenIds,
    uint256 _gasLimit
) external payable;

function batchDepositERC1155(
    address _token,
    uint256[] calldata _tokenIds,
    uint256[] calldata _amounts,
    uint256 _gasLimit
) external payable;

function batchDepositERC1155(
    address _token,
    address _to,
    uint256[] calldata _tokenIds,
    uint256[] calldata _amounts,
    uint256 _gasLimit
) external payable;
```

ERC-721 veya ERC-1155 tokenların L2'deki karşılıklı sözleşmeleri `L2ERC721Gateway` ve `L2ERC1155Gateway`'dir. Bunlar, L2'deki yatırımlarını finalize etmek için kullanılır.
