---
section: technology
date: Last Modified
title: "Çekim Geçitleri (Withdraw Gateways)"
lang: "tr"
permalink: "technology/bridge/withdraw-gateways"
whatsnext: { "Sequencer": "/tr/technology/sequencer/execution-node/" }
---

import ClickToZoom from "../../../../../components/ClickToZoom.astro"
import Aside from "../../../../../components/Aside.astro"
import WithdrawWorkflow from "../_images/withdraw.png"

Bu belge, kullanıcıların ve geliştiricilerin L2'den L1'e token çekmek için geçitleri nasıl kullanacaklarını açıklar. Standart tokenlar için birkaç geçit ve L2'deki bir geçit yönlendirici sunuyoruz. Aşağıdaki tabloda listelenmiştir.

| Gateway Contract         | Description                                                         |
| ------------------------ | ------------------------------------------------------------------- |
| `L2GatewayRouter`        | ETH ve ERC20 tokenlarının çekimlerini destekleyen geçit kapısı.     |
| `L2ETHGateway`           | ETH çekimleri için geçiş kapısı.                                    |
| `L2StandardERC20Gateway` | Standart ERC20 token çekimleri için geçiş kapısı.                   |
| `L2CustomERC20Gateway`   | Özel ERC20 token çekimleri için geçiş kapısı.                       |
| `L2WETHGateway`          | Wrapped ETH çekimleri için geçiş kapısı.                            |
| `L2ERC721Gateway`        | ERC721 token çekimleri için geçiş kapısı.                           |
| `L2ERC1155Gateway`       | ERC1155 token çekimleri için geçiş kapısı.                          |

## Overview

<ClickToZoom src={WithdrawWorkflow} alt="Withdraw Workflow" />

Şekil, L2'den L1'e yapılan çekme iş akışını göstermektedir. Kullanıcılar, token çekmeyi başlatmak için geçitleri ararlar. Çekme işlemi, `L2MessageQueue`'ye eklenecek olan bir mesaja kodlanır ve ardından `L2ScrollMessenger`'a gönderilir. `L2MessageQueue`, bir çekim trie'sini korur ve her yeni mesaj eklenirken kökü günceller. Yeni Çekim Trie kökü, L2 root kökü ile birlikte L1 rollup sözleşmesinde nihai hale getirilir. Yeni Çekim Trie kökü, L1'de nihai hale getirildikten sonra, kullanıcılar veya üçüncü taraflar, Çekim Trie köküne geçerli bir Merkle İçerme Kanıtı oluşturabilir ve L1'deki çekimi sonlandırmak için bir _çekim gerçekleştirme_ işlemi gönderebilirler. L2'den L1'e mesaj iletim iş akışı hakkında daha fazla ayrıntıyı [Cross-Domain Mesaj İletimi](/tr/technology/bridge/cross-domain-messaging#sending-messages-from-l2-to-l1) bölümünde bulabilirsiniz.

Sıradaki bölümler, farklı tokenların nasıl çekilebildiği hakkında ayrıntıları açıklar.

## ETH Çekimi

ETH token çekme işlemi aşağıdaki şekilde gerçekleşir.

1. 
`L2GatewayRouter`, L2'den L1'e ETH çekmek için üç fonksiyon sağlar. `withdrawETHAndCall` fonksiyonu, ETH çekme işlemini gerçekleştirirken aynı anda bir akıllı sözleşme çağrısını da yürütebilir.

    ```solidity
    function withdrawETH(uint256 _amount, uint256 _gasLimit) external payable;

    function withdrawETH(address _to, uint256 _amount, uint256 _gasLimit) public payable;

    function withdrawETHAndCall(
        address _to,
        uint256 _amount,
        bytes calldata _data,
        uint256 _gasLimit
    ) external payable;
    ```

2. `withdrawETHAndCall` fonksiyonu, `L2ETHGateway`'e çağrı yapar. `L2ETHGateway`, çekme işlemi mesajını kodlar ve çekilen ETH ile birlikte `L2ScrollMessenger` sözleşmesine gönderir.
3. Çekilen ETH tekrar `L2ScrollMessenger` sözleşmesinde kilitlenir. `L2ScrollMessenger`, mesajı `L2MessageQueue` sözleşmesindeki mesaj kuyruğuna ekler.
4. L1'deki çekme işlemi işlemi, çekilmeyi tamamlamak için `L1ScrollMessenger.relayMessageWithProof` fonksiyonunu çağırır. ETH çekme durumunda, `relayMessageWithProof` fonksiyonu, ETH'yi L1'deki alıcı hesaba geri göndermek için `L1ETHGateway.finalizeWithdrawETH`'i çağırır.
5. Kullanıcı L2'de `withdrawETHAndCall` fonksiyonunu çağırırsa, `L1ETHGateway` sözleşmesindeki `finalizeWithdrawETH` ek verileri hedef L1 sözleşmesine iletir.

## ERC20 Token Çekimi

ERC20 token çekme işlemi aşağıdaki gibi çalışır.

1. L1'den L2'ye ERC20 token çekmek için, kullanıcılar aşağıda gösterilen `L2GatewayRouter.withdrawERC20` ve `L2GatewayRouter.withdrawERC20AndCall` fonksiyonlarını kullanabilir.

    ```solidity
    function withdrawERC20(address _token, uint256 _amount, uint256 _gasLimit) external payable;

    function withdrawERC20(address _token, address _to, uint256 _amount, uint256 _gasLimit) external payable;

    function withdrawERC20AndCall(
        address _token,
        address _to,
        uint256 _amount,
        bytes memory _data,
        uint256 _gasLimit
    ) public payable;
    ```

2. ERC20 tokenlere yapılan çekme işlemi, ERC20 tokenlerinin geçidi olan `L2StandardERC20Gateway`, `L2CustomERC20Gateway` veya `L2WETHGateway`'e yönlendirme yapar. Geriye kalan adımlar ayrıntılı olarak açıklanacaktır.

### Standart ve Özel ERC20 Tokenler

Standart ve özel ERC20 tokenlerin çekilmesi aşağıdaki gibi aynı şekilde çalışır.

3. `L2StandardERC20Gateway` veya `L2CustomERC20Gateway` sözleşmesi çekilen ERC20 tokenlerini yakar, çekmeyi bir mesaja kodlar ve `L2ScrollMessenger`'a gönderir.
4. L1 çekme işlemi işlemi, çekilmeyi tamamlamak için `L1ScrollMessenger.relayMessageWithProof` fonksiyonunu çağırır. Standart veya özel ERC20 token çekme durumunda, işlem sırasında ilgili `L1StandardERC20Gateway` veya `L1CustomERC20Gateway` sözleşmesinde `finalizeWithdrawERC20` fonksiyonu çağrılır. `L1StandardERC20Gateway` sözleşmesinde, bu bir ERC20 tokeninin ilk çekme işlemi ise, `finalizeWithdrawERC20` fonksiyonu, L1 token adresinden L2 token adresine eşleme yapılan `tokenMapping`'i günceller.
5. L1 ERC20 token geçidi, kilitli ERC20 tokenleri kendisinden L1 üzerindeki alıcı adresine aktararak serbest bırakır.
6. Kullanıcı L2'de `withdrawERC20AndCall` fonksiyonunu çağırırsa, geçitler ilgili ek verilerle hedef L1 sözleşmesini çağırır.

### WETH Token

L2'de Wrapped ETH token için özel bir geçit olan `L2WETHGateway`'e sahibiz ve geçit adresini `L2GatewayRouter`'a kaydediyoruz. WETH tokeninin çekilmesi aşağıdaki gibi çalışır.

3. `L2WETHGateway`, çekilen WETH tokenini kendisine aktarır ve WETH tokenini yerel ETH tokenine çıkarır. ETH tokeni ardından `L2ScrollMessenger` sözleşmesine geri gönderilir.
4. `L2WETHGateway`, token çekme mesajını kodlar ve `L2ScrollMessenger`'a iletir.
5. L1 çekme işlemi işlemi, çekilmeyi tamamlamak için `L1ScrollMessenger.relayMessageWithProof` fonksiyonunu çağırır. WETH tokeni çekme durumunda, işlem sırasında ilgili `L1WETHGateway` sözleşmesinde `finalizeWithdrawERC20` fonksiyonu çağrılır ve çekilen miktar ETH cinsinden `L1WETHGateway`'e gönderilir.
6. `L1WETHGateway`, çekilen ETH'i L1 WETH tokenine tekrar sarar ve L1'deki alıcı adresine aktarır.
7. Kullanıcı L2'de `withdrawERC20AndCall` fonksiyonunu çağırırsa, `L1WETHGateway` ilgili ek verilerle hedef L1 adresini çağırır.

## ERC-721/ERC-1155 Tokenlerin Çekilmesi

ERC-721 veya ERC-1155 tokenlerin çekilmesi, ERC20 tokenlerine çok benzer şekilde çalışır. ERC-721/ERC-1155 tokenlerini L2'den çekmek için `L2ERC721Gateway` veya `L2ERC1155Gateway` geçitlerini kullanabilirsiniz.

```solidity
function withdrawERC721(
    address _token,
    uint256 _tokenId,
    uint256 _gasLimit
) external payable;

function withdrawERC721(
    address _token,
    address _to,
    uint256 _tokenId,
    uint256 _gasLimit
) external payable;

function withdrawERC1155(
    address _token,
    uint256 _tokenId,
    uint256 _amount,
    uint256 _gasLimit
) external payable;

function withdrawERC1155(
    address _token,
    address _to,
    uint256 _tokenId,
    uint256 _amount,
    uint256 _gasLimit
) external payable;
```

Büyük miktarda ERC-721 veya ERC-1155 token çekme işlemlerini kolaylaştırmak için, `L2ERC721Gateway` ve `L2ERC1155Gateway` sözleşmelerinde toplu çekme işlevleri de sunuyoruz. Bunlar aşağıdaki işlevler aracılığıyla sağlanır:

```solidity
function batchWithdrawERC721(
    address _token,
    uint256[] calldata _tokenIds,
    uint256 _gasLimit
) external payable;

function batchWithdrawERC721(
    address _token,
    address _to,
    uint256[] calldata _tokenIds,
    uint256 _gasLimit
) external payable;

function batchWithdrawERC1155(
    address _token,
    uint256[] calldata _tokenIds,
    uint256[] calldata _amounts,
    uint256 _gasLimit
) external payable;

function batchWithdrawERC1155(
    address _token,
    address _to,
    uint256[] calldata _tokenIds,
    uint256[] calldata _amounts,
    uint256 _gasLimit
) external payable;
```

ERC-721 veya ERC-1155 tokenları için L1 karşılığı olan sözleşmeler `L1ERC721Gateway` ve `L1ERC1155Gateway`'dir ve L1'de çekilmelerin finalize edilmesini sağlar.
